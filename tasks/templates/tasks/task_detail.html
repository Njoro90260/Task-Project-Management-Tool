{% extends 'projects/base.html' %}

{% block title %}Task Detail{% endblock title %}

{% block content %}


<div class="container">
    <h1>{{ task.title }}</h1>
    <p>{{ task.task_description }}</p>
    <p><strong>Assigned to:</strong> {{ task.assigned_to.username }}</p>
    <p><strong>Created at:</strong> {{ task.created_at }}</p>

    <hr>

    <h3>Comments</h3>
    <form id="comment-form" data-url="{% url 'tasks:add_comment' task.id %}">
        {% csrf_token %}
        <textarea id="comment-text" placeholder="Add a comment..." required>@</textarea>
        <ul id="mention-suggestions" class="suggestion-box"></ul> 
        <!-- suggestion-list -->
        <button type="submit">Post Comment</button>
    </form>

    <ul id="comment-list">
        {% for comment in comments %}
        <li><strong>{{ comment.author.username }}:</strong> {{ comment.content }}</li>
        {% empty %}
        <li>
            <p>No comments yet.</p>
        </li>
        {% endfor %}
    </ul>
    </form>


    <form id="file-upload-form" enctype="multipart/form-data">
        {% csrf_token %}
        <input type="file" id="file-input" name="file" required>
        <button type="submit">Upload File</button>
    </form>
    
    <ul id="file-list">
        {% for file in task.files.all %}
            <li><a href="{{ file.file.url }}" download>{{ file.file.name }}</a></li>
        {% endfor %}
    </ul>
</div>
{% endblock content %}